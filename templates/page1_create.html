<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>åˆ›å»ºå®ˆæŠ¤å¤©ä½¿æˆ¿é—´</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        h1, h2 { color: #4CAF50; }
        input[type="text"], input[type="number"], button { padding: 10px; margin: 5px 0; width: 100%; box-sizing: border-box; border: 1px solid #ddd; border-radius: 4px; }
        button { background-color: #4CAF50; color: white; cursor: pointer; }
        button:hover { background-color: #45a049; }
        .success { color: green; border: 1px solid green; padding: 10px; background-color: #e6ffe6; border-radius: 4px; }
        .danger { color: red; border: 1px solid red; padding: 10px; background-color: #ffe6e6; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>ğŸŒŸ åˆ›å»ºå®ˆæŠ¤å¤©ä½¿æˆ¿é—´</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <p class="{{ category }}">{{ message }}</p>
            {% endfor %}
        {% endif %}
    {% endwith %}

    {% if join_url %}
        <h2>æˆ¿é—´åˆ›å»ºæˆåŠŸï¼</h2>
        <p>æˆ¿é—´åï¼š<strong>{{ room_name }}</strong></p>
        <p>è¯·åˆ†äº«æ­¤é“¾æ¥ç»™æ‚¨çš„æœ‹å‹ä»¬ï¼š</p>
        <input type="text" id="joinUrlInput" value="{{ join_url }}" readonly>
        <button onclick="copyLink()">å¤åˆ¶é“¾æ¥</button>
        <p style="text-align: center;"><a href="{{ join_url }}" style="color: #007BFF;">ç‚¹å‡»è¿›å…¥æˆ¿é—´å¼€å§‹ç™»è®°</a></p>

        <script>
            function copyLink() {
                var copyText = document.getElementById("joinUrlInput");
                copyText.select();
                copyText.setSelectionRange(0, 99999);
                navigator.clipboard.writeText(copyText.value);
                alert("é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼");
            }
        </script>
    {% else %}
        <form method="POST">
            <label for="room_name">æˆ¿é—´åç§° (ä¾‹å¦‚: éƒ¨é—¨åœ£è¯æŠ½ç­¾):</label>
            <input type="text" id="room_name" name="room_name" required><br>

            <label for="target_count">é¢„è®¾å‚ä¸äººæ•°ä¸Šé™ (Nï¼Œè‡³å°‘ 2 äºº):</label>
            <input type="number" id="target_count" name="target_count" min="2" required><br>

            <button type="submit">åˆ›å»ºå¹¶åˆ†äº«é“¾æ¥</button>
        </form>
    {% endif %}
</body>
</html>